flowchart LR
 subgraph INPUT["输入数据层"]
        A1["附件1：54个地块信息"]
        A2["附件2：41种作物数据"]
        A3["7类种植约束"]
  end
 subgraph PREP["数据预处理"]
        B1["地块分类：粮食/水浇/大棚"]
        B2["作物参数：产量·成本·价格"]
        B3["兼容矩阵：54×41地块-作物关系"]
  end
 subgraph ALGO1["粮食地块(26个)"]
        D1["动态规划算法"]
        D1_1["状态：年份/作物/豆类计数"]
        D1_2["状态转移方程"]
        D1_3["记忆化搜索求解"]
  end
 subgraph ALGO2["水浇地(8个)"]
        D2["混合整数规划"]
        D2_1["面积决策变量"]
        D2_2["0-1种植指示变量"]
        D2_3["Gurobi求解器"]
  end
 subgraph ALGO3["大棚(20个)"]
        D3["贪心算法"]
        D3_1["按收益排序作物"]
        D3_2["约束条件筛选"]
        D3_3["局部最优选择"]
  end
 subgraph SOL["解决方案"]
        E1["粮食地块7年计划"]
        E2["水浇地7年计划"]
        E3["大棚7年计划"]
  end
 subgraph VALID["约束验证"]
        G1{"重茬约束"}
        G2{"豆类轮作"}
        G3{"面积限制"}
        G4{"适应性匹配"}
  end
 subgraph CALC["收益计算"]
        H1["情景1：超产滞销"]
        H2["情景2：折价50%"]
        H3["收益提升分析"]
  end
 subgraph OUTPUT["输出结果"]
        I1["情景1种植计划"]
        I2["情景2种植计划"]
        I3["优化报告"]
  end
    A1 --> B1
    A2 --> B2
    A3 --> B3
    B1 --> C1["分层分治策略"]
    B2 --> C1
    B3 --> C1
    C1 --> ALGO1 & ALGO2 & ALGO3
    D1_3 --> E1
    D2_3 --> E2
    D3_3 --> E3
    E1 --> F1["全局方案整合"]
    E2 --> F1
    E3 --> F1
    F1 --> G1 & G2 & G3 & G4
    G1 --> H1
    G2 --> H1
    G3 --> H2
    G4 --> H2
    H1 --> I1 & H3
    H2 --> I2 & H3
    H3 --> I3

    C1@{ shape: hex}
    linkStyle 10 stroke:#000000,fill:none